<!DOCTYPE html>
<html lang="en">

<head>
            <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">

        <title>gpilab.com</title>

            <link href="https://gpilab.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="gpilab.com Full Atom Feed" />
            <link href="https://gpilab.com/feeds/posts.atom.xml" type="application/atom+xml" rel="alternate" title="gpilab.com Categories Atom Feed" />

        <!-- Bootstrap Core CSS -->
        <link href="https://gpilab.com/theme/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="https://gpilab.com/theme/css/clean-blog.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
            <link href="https://gpilab.com/theme/css/code_blocks/darkly.css" rel="stylesheet">

        <!-- Custom Fonts -->
        <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->






			<meta property="og:locale" content="en">
		<meta property="og:site_name" content="gpilab.com">

	<meta property="og:type" content="article">
	<meta property="article:author" content="">
	<meta property="og:url" content="https://gpilab.com/2019/05/ismrm-demo-cs-with-bart-in-gpi/">
	<meta property="og:title" content="ISMRM Demo: CS with BART in GPI">
	<meta property="og:description" content="">
	<meta property="og:image" content="https://gpilab.com//images/ismrm2019_bart.png">
	<meta property="article:published_time" content="2019-05-07 08:59:00-07:00">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://gpilab.com/">gpilab.com</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">

                    <!-- NRZ manually added -->
                    <li><a href="/">Home</a></li>


                            <li><a href="https://gpilab.com/downloads/">Install GPI</a></li>
                            <li><a href="https://gpilab.com/screencasts/">Tutorials</a></li>
                            <li><a href="https://gpilab.com/documentation/">Documentation</a></li>
                            <li><a href="https://gpilab.com/community/">Community</a></li>
                            <li><a href="https://gpilab.com/about/">About</a></li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-image: url('/images/ismrm2019_bart.png')">
        <div class="container intro-header-overlay">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>ISMRM Demo: CS with BART in GPI</h1>
                        <span class="meta">Posted by
                                <a href="https://gpilab.com/author/ashley-anderson-iii.html">Ashley Anderson III <aganders3@gmail.com></a>
                             on Tue 07 May 2019
                        </span>
                        
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <!-- Post Content -->
    <article>
        <p>As part of our GPI demo at at the <a href="https://www.ismrm.org/19/program_files/WE21.htm">ISMRM 2019 Open-Source Software Tools for MR
Pulse Design, Simulation &amp; Reconstruction Weekend
Course</a>, we've revived an
example of BART working inside GPI. This example is intended to demonstrate the
flexibility and capabilities of GPI to integrate other packages. This demo also
highlights the use of GPI as a teaching tool; the example is based on <a href="http://people.eecs.berkeley.edu/~mlustig/CS.html">this
example from Professor
Lustig</a>.</p>
<p>Before getting started here, please see Nick's post on <a href="{static}/posts/2019-05-05-ISMRM-Demo-Primer.md">setting up GPI for the
ISMRM 2019 demo</a>.</p>
<hr>
<h1>Download and Compile BART for GPI</h1>
<p><a href="https://github.com/nckz/bart">BART for GPI</a> is a fork of the <a href="https://github.com/mrirecon/bart">BART
project</a>. We concede this fork is out of
date, but it should suffice for a demonstation. Updating to a newer version
would be fairly trivial for someone familiar with both BART and GPI. Check
out Nick's <em>other</em> post on <a href="{static}/posts/2016-02-16-GPI-and-the-BART.md">how BART was wrapped for use in
GPI</a> if you're interested in
making this work.</p>
<p>First, prepare your virtual machine for BART compilation:</p>
<div class="highlight"><pre><span></span><code>&gt; sudo apt-get install git gcc make libfftw3-dev liblapack-dev libpng-dev
</code></pre></div>

<p>If you're using the GPI ISMRM 2019 demo VM or AMI on EC2, the password for the
<code>ubuntu</code> user is <code>gpilab</code>.</p>
<p>Next clone the BART for GPI fork into your <code>gpi</code> library folder:</p>
<div class="highlight"><pre><span></span><code>&gt; git clone https://github.com/nckz/bart.git /home/<span class="cp">${</span><span class="n">USER</span><span class="cp">}</span>/gpi/bart
</code></pre></div>

<p>Finally, build and test BART:</p>
<div class="highlight"><pre><span></span><code>&gt; cd ~/gpi/bart
&gt; make
&gt; ./bart bench
</code></pre></div>

<p>If you're not working in the GPI VM, instead follow the instructions in the
BART for GPI README.</p>
<h1>Launch GPI and Open the Example</h1>
<p>Open GPI using the startup script or from a terminal. Right click anywhere on
the canvas and you should see a new Library in the menu called <code>bart</code>. GPI
Libraries can contain both nodes and networks. Most BART functions should have
corresponding nodes here, but for now go ahead and select the <code>brain_cs_example
(net)</code> near the bottom of the menu.</p>
<p><img src="https://gpilab.com/images/ismrm2019_bart/network_select.png" width="75%" class="center-block img-responsive"/></p>
<p>The demo network will be loaded on the canvas, and the <code>DownloadFile</code> node
should begin downloading the example data. This data (about 5 MB) will be
stored in a temporary file.</p>
<p><img src="https://gpilab.com/images/ismrm2019_bart/network_overview.png" width="75%" class="center-block img-responsive"/></p>
<h1>Configure and Run the Network</h1>
<p>Note the three <code>ReadMatlab</code> nodes. Each is reading data from the same file (the
one downloaded by the <code>DownloadFile</code> node) which contains several arrays.
Right-click on each of these nodes to open their node menus. In the menu you
will be able to select which array is output. From left to right we need to
select the sampling mask, the image, and the sampling pdf.</p>
<p><img src="https://gpilab.com/images/ismrm2019_bart/ReadMatlab_select.png" class="center-block img-responsive"/></p>
<p>Right-click on a few of the <code>ImageDisplay</code> nodes to probe the algorithm at
various points. The <code>ImageDisplay</code> node labeled <code>CS Image</code> is the
compressed-sensing reconstruction (though at this point it is only the inital
condition based on zero-filling).</p>
<p>Open the <code>Iter</code> node and click the "Start/Stop" button to begin the iterative
reconstruction. The <code>CS Image</code> will be updated with each iteration, and you can
watch as the undersampling artifacts are removed by the wavelet-based
soft-thresholding constraint.</p>
<p><img src="https://gpilab.com/images/ismrm2019_bart/cs_example_animated.gif" class="center-block img-responsive"/></p>
<p>There you have it! Explore the rest of the BART tools in GPI and let us know if
you come up with any cool examples.</p>
    </article>

    <hr>

            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                        <li>
                            <a href="https://github.com/gpilab">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://www.youtube.com/user/gpilab">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-youtube fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://docs.gpilab.com">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-book fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>

                    <p class="copyright text-muted">
                    &copy; Copyright 2022 Nicholas Zwart, Jim Pipe, Ashley Anderson, Daniel Borup, Abdulrahman Alfayad
                    </p>

                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <!-- <script src="https://gpilab.com/theme/js/jquery.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script>
        /* banner fade */
        var src = $(".intro-header").css('background-image');
        var url = src.match(/\((.*?)\)/)[1].replace(/('|")/g,'');

        var img = new Image();
        img.onload = function() {
            $( ".intro-header-overlay" ).fadeTo(700, 1)
        }
        img.src = url;
        if (img.complete) img.onload();
    </script>

    <!-- Bootstrap Core JavaScript -->
    <script src="https://gpilab.com/theme/js/bootstrap.min.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="https://gpilab.com/theme/js/clean-blog.min.js"></script>

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-55259609-4']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
</body>

</html>